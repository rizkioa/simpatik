{% extends "admin/base_site.html" %}
{% load i18n admin_static %}

{% block breadcrumbs %}
{% endblock %}

{% block extrastyle %}
	{{ block.super }}
	<link rel="stylesheet" href="{% static 'scripts/js/vendor/chosen/chosen.min.css' %}">
	<link rel="stylesheet" href="{% static 'scripts/js/vendor/datetimepicker/css/bootstrap-datetimepicker.min.css'  %}">
	<link rel="stylesheet" href="{% static 'scripts/js/vendor/lightbox/css/lightbox.css'  %}">
	<link rel="stylesheet" href="{% static 'scripts/js/mloading/jquery.mloading.css' %}">
	<style type="text/css">
		.label-color{
			color: white;
		}
		.style14 { 
			border: 0; 
			height: 1px; 
			background-image: -webkit-linear-gradient(left, #f0f0f0, #8c8b8b, #f0f0f0);
			background-image: -moz-linear-gradient(left, #f0f0f0, #8c8b8b, #f0f0f0);
			background-image: -ms-linear-gradient(left, #f0f0f0, #8c8b8b, #f0f0f0);
			background-image: -o-linear-gradient(left, #f0f0f0, #8c8b8b, #f0f0f0); 
		}
		.hovereffect {
		  width: 100%;
		  height: 100%;
		  float: left;
		  overflow: hidden;
		  position: relative;
		  text-align: center;
		  cursor: default;
		  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
		}

		.hovereffect .overlay {
		  width: 100%;
		  height: 100%;
		  position: absolute;
		  overflow: hidden;
		  top: 0;
		  left: 0;
		}

		.hovereffect img {
		  display: block;
		  position: relative;
		  -webkit-transition: all 0.4s ease-in;
		  transition: all 0.4s ease-in;
		}

		.hovereffect:hover img {
		  filter: url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg"><filter id="filter"><feColorMatrix type="matrix" color-interpolation-filters="sRGB" values="0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0" /><feGaussianBlur stdDeviation="3" /></filter></svg>#filter');
		  filter: grayscale(1) blur(3px);
		  -webkit-filter: grayscale(1) blur(3px);
		  -webkit-transform: scale(1.2);
		  -ms-transform: scale(1.2);
		  transform: scale(1.2);
		}

		.hovereffect h2 {
		  text-transform: uppercase;
		  text-align: center;
		  position: relative;
		  font-size: 17px;
		  padding: 10px;
		  background: rgba(0, 0, 0, 0.6);
		}

		.hovereffect a.info {
		  display: inline-block;
		  text-decoration: none;
		  padding: 7px 14px;
		  border: 1px solid #fff;
		  margin: 0px 0 0 0;
		  background-color: transparent;
		}

		.hovereffect a.info:hover {
		  box-shadow: 0 0 5px #fff;
		}

		.hovereffect a.info, .hovereffect h2 {
		  -webkit-transform: scale(0.7);
		  -ms-transform: scale(0.7);
		  transform: scale(0.7);
		  -webkit-transition: all 0.4s ease-in;
		  transition: all 0.4s ease-in;
		  opacity: 0;
		  filter: alpha(opacity=0);
		  color: #fff;
		  text-transform: uppercase;
		}

		.hovereffect:hover a.info, .hovereffect:hover h2 {
		  opacity: 1;
		  filter: alpha(opacity=100);
		  -webkit-transform: scale(1);
		  -ms-transform: scale(1);
		  transform: scale(1);
		}
		.imageloaderImage{
			height: 200px;
			width: 100%;
		}
		.img-responsi{
			float:left;
			width:90%;
			height:90%;
			margin:5%;
			background-size:contain;
			background-repeat:no-repeat;
			background-position:center;
		}
	</style>
{% endblock %}

{% block content %}
	<div class="row">
		<div class="col-lg-12">
			<section class="tile">
				<div class="tile-header dvd dvd-btm">
					<h1 class="custom-font"> {{ title }} </h1>
					<ul class="controls">
						<li class="dropdown">
							<a role="button" tabindex="0" class="dropdown-toggle settings" data-toggle="dropdown">
								<i class="fa fa-cog"></i>
								<i class="fa fa-spinner fa-spin"></i>
							</a>
							<ul class="dropdown-menu pull-right with-arrow animated littleFadeInUp">
								<li>
									<a role="button" tabindex="0" class="tile-toggle">
										<span class="minimize"><i class="fa fa-angle-down"></i>&nbsp;&nbsp;&nbsp;Minimize</span>
										<span class="expand"><i class="fa fa-angle-up"></i>&nbsp;&nbsp;&nbsp;Expand</span>
									</a>
								</li>
								<li>
									<a role="button" tabindex="0" class="tile-refresh">
										<i class="fa fa-refresh"></i> Refresh
									</a>
								</li>
								<li>
									<a role="button" tabindex="0" class="tile-fullscreen">
										<i class="fa fa-expand"></i> Fullscreen
									</a>
								</li>
							</ul>
						</li>
						<li class="remove"><a role="button" tabindex="0" class="tile-close"><i class="fa fa-times"></i></a></li>
					</ul>
				</div>
				<div class="tile-body">
					<div class="row">
						<div class="col-md-12">
							<div class="panel panel-darkgray">
								<div class="panel-body">
									<div class="row">
										<div class="col-md-12 table-responsive">
											<table class="table table-striped table-bordered table-perincian" width="100%" border="0">
												<thead class="thead-dark">
													<tr>
														<th width="25%">Nama Perincian</th>
														<th width="35%">Persyaratan</th>
														<th width="20%">keterangan</th>
														<th width="20%">Memenuhi Syarat</th>
													</tr>
												</thead>
												<tbody></tbody>
											</table>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</section>
		</div>
	</div>
{% endblock %}

{% block extrajs_site %}
{{block.super}}
<script src="{% static 'scripts/js/vendor/screenfull/screenfull.min.js' %}"></script>
<script src="{% static 'scripts/js/vendor/filestyle/bootstrap-filestyle.min.js' %}"></script>
<script src="{% static 'scripts/js/vendor/chosen/chosen.jquery.js' %}"></script>
<script src="{% static 'scripts/js/vendor/daterangepicker/moment.js' %}"></script>
<script src="{% static 'scripts/js/vendor/datetimepicker/js/bootstrap-datetimepicker.min.js' %}"></script>
<script src="{% static 'scripts/js/form/chossen_stuf.js' %}"></script>
<script src="{% static 'scripts/js/vendor/parsley/parsley.js' %}"></script>
<script src="{% static 'scripts/js/vendor/screenfull/screenfull.min.js' %}"></script>
<script src="{% static 'scripts/js/mloading/jquery.mloading.js' %}"></script>
<script src="{% static 'scripts/js/vendor/lightbox/js/lightbox.js' %}"></script>
<script type="text/javascript">
	{% if data %}
		perincian_list = JSON.parse('{{data|safe}}')
		console.log(perincian_list) 
		len = perincian_list.data.length
		if (perincian_list.success == true){
			row = '<tr>'
			if(len > 0){
				for(var i=0; i<len; i++){
					if(perincian_list.data[i].nama_perincian == null){
						row += '<td></td>'
					}else{
						if(perincian_list.data[i].level == 0){
							row += '<td>'+perincian_list.data[i].nama_perincian+'</td>'
						}else if(perincian_list.data[i].level == 1){
							row += '<td style="padding-left:30px">'+perincian_list.data[i].nama_perincian+'</td>'
						}else if(perincian_list.data[i].level == 2){
							row += '<td style="padding-left:40px">'+perincian_list.data[i].nama_perincian+'</td>'
						}else if(perincian_list.data[i].level == 3){
							row += '<td style="padding-left:50px">'+perincian_list.data[i].nama_perincian+'</td>'
						}else if(perincian_list.data[i].level == 4){
							row += '<td style="padding-left:60px">'+perincian_list.data[i].nama_perincian+'</td>'
						}

					}
					row += '<td style="padding-left=10px">'+perincian_list.data[i].persyaratan+'</td>'
					row += '<td class="kenyataan__'+perincian_list.data[i].id+'"></td>'
					if(perincian_list.data[i].perlu_diisi == true){
						row += '<td data-url-load="{{url_server_dinkes}}admin/izin/pemeriksaanizin/{{ no_pengajuan }}/'+perincian_list.data[i].id+'/get-pemeriksaan-json/?key={{key}}" data-status="unload" data-row="'+perincian_list.data[i].id+'"></td>'
					}
					
					row += '</tr>'
				}
				
			}else{
				row = '<td align=center colspan=4>Kosong</td>'
			}
			$('.table-perincian > tbody').html(row)
		}
	{% else %}
		$('.table-perincian > tbody').html('<td align=center colspan=4>Gagal Mengambil Data, Cek Url Server</td>')
	{% endif %}

	function load_penilaian(elemen_){
        $.ajax({
            url: elemen_.data('url-load'),
            type: 'GET',
            success: function(respon){
                respon = JSON.parse(respon)
                if(respon.success == true){
                    elemen_.attr('data-status', 'loaded');
                    if(respon.data){
                    	if(respon.data.memenuhi_syarat == true){
                    		// alert('masuk')
	                        elemen_.text('YA')   
	                    }

	                    $('.kenyataan__'+elemen_.data('row')).text(respon.data.keterangan)
                    
                    }
                    load_penilaian($('td[data-status=unload]').first())
                }
                else{
                    load_penilaian($('td[data-status=unload]').first())
                }
                
            },
            error: function(){
                load_penilaian($('td[data-status=unload]').first())
            }
        })
    }
    $(document).ready(function() {
    	// console.log('{{url_server_dinkes}}admin/izin/pemeriksaan/64124/].id+'/get-pemeriksaan-json/?key={{key}}')
        load_penilaian($('td[data-status=unload]').first())
    });
</script>
{% endblock %}